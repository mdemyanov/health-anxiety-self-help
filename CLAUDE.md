# CLAUDE.md — AI-инструкции

Инструкции для Claude Code при работе с проектом health-anxiety-self-help.

---

## О проекте

PWA-приложение самопомощи для руководителей IT-компаний (35-50 лет).
Объединяет КПТ (когнитивно-поведенческую терапию) и стоическую философию.

**Версия**: 3.2 | **Стек**: React 18 + Vite + Tailwind CSS 4 + Framer Motion

---

## Документация

| Файл | Содержание |
|------|------------|
| [PRD.md](./PRD.md) | Продукт, аудитория, roadmap, история |
| [ARCHITECTURE.md](./ARCHITECTURE.md) | Техническая архитектура, структура, тестирование |
| [health-anxiety-self-help-guide.md](./health-anxiety-self-help-guide.md) | Контент и методички |

---

## Критичные правила

### 1. НЕ использовать библиотеку `liquid-glass-react`

Библиотека создаёт canvas overlay, который **блокирует все pointer events**.

```jsx
// ❌ НЕ ДЕЛАТЬ — кнопки не будут кликабельны
import LiquidGlass from 'liquid-glass-react';
<LiquidGlass><button>Click me</button></LiquidGlass>

// ✅ ПРАВИЛЬНО — использовать CSS классы
<button className="btn-glass">Click me</button>
<div className="liquid-glass">Content</div>
```

### 2. Стиль сообщений

Используй **дружелюбный стиль** — обращение на "ты":
- "Давай разберёмся вместе"
- "Отлично! Идём дальше"
- "Как ты себя чувствуешь?"
- "Ты справился!"

### 3. Ключевые паттерны

| Что | Где |
|-----|-----|
| Chat flows | `src/flows/*.js` (13 конфигураций) |
| Chat компоненты | `src/components/chat/` |
| Хуки | `useChatFlow`, `useTimer`, `useLocalStorage`, `useHaptic` |
| Страница чата | `src/pages/chat/ChatTool.jsx` |

### 4. UX-паттерн: интерактивные практики в чате

Для практик с визуальным контентом (дыхание, таймеры и т.д.) используй **двухэтапный UX**:

1. **Кнопка инициации** — в области ввода (внизу экрана), пользователь сам запускает практику
2. **Оверлей с практикой** — полноэкранный центрированный виджет, не влияет на layout чата

```
┌─────────────────────────┐
│  Chat Header            │
├─────────────────────────┤
│                         │
│  Сообщения чата         │
│  ...                    │
│                         │
├─────────────────────────┤
│  [🫁 Начать дыхание]    │  ← Кнопка в области ввода
└─────────────────────────┘
         ↓ клик
┌─────────────────────────┐
│  ░░░░░░░░░░░░░░░░░░░░░  │
│  ░░ ╔═══════════════╗ ░░ │
│  ░░ ║   ◯ Вдох      ║ ░░ │  ← Центрированный оверлей
│  ░░ ╚═══════════════╝ ░░ │
│  ░░░░░░░░░░░░░░░░░░░░░  │
└─────────────────────────┘
```

**Почему так:**
- Пользователь контролирует момент начала практики
- Оверлей не "прыгает" с сообщениями чата
- Единообразное расположение кнопок действия (всегда внизу)

**Реализация:** см. `awaitingBreathing` в `useChatFlow.js` и `BreathingOverlay` в `src/components/chat/overlays/`

---

## Команды

```bash
npm run dev           # Dev-сервер
npm run build         # Сборка
npm run test          # Unit-тесты
npm run test:e2e      # E2E тесты
npm install --legacy-peer-deps  # Установка
```

---

## Когнитивные искажения (для ABC-дневника)

1. Катастрофизация
2. Предсказание будущего
3. Чёрно-белое мышление
4. Эмоциональное обоснование
5. Сверхобобщение
6. Чтение мыслей
7. Долженствование
8. Персонализация
9. Туннельное зрение
10. Минимизация позитивного

---

*Последнее обновление: 17 января 2026*
