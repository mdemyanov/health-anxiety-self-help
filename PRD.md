# PRD — Health Anxiety Self-Help (Executive Edition)

Продуктовые требования для мобильного PWA-приложения самопомощи.

---

## Общая информация

| Параметр | Значение |
|----------|----------|
| Версия | 4.0 (Executive Edition) |
| Последнее обновление | 17 января 2026 |
| Деплой | Yandex Object Storage (GitHub Actions) |

---

## Целевая аудитория

- **Возраст**: 35-50 лет
- **Роль**: CEO, CTO, CPO, директора IT-компаний в России
- **Основной фокус**: управленческий стресс, принятие решений, баланс работа-семья
- **Вторичный фокус**: здоровье как часть жизни руководителя 35+

---

## Методология

### Книги-основы

- **"Думай как римский император"** (Donald Robertson) — стоические практики
- **"Терапия настроения"** (David Burns) — 10 когнитивных искажений и техники КПТ

### Терапевтический подход

Объединение когнитивно-поведенческой терапии (КПТ) и стоической философии для управления стрессом и тревогой.

---

## Профиль пользователя

### Демография

- **Возраст**: 35-50 лет
- **Роль**: CEO, CTO, CPO, директор IT-компании
- **Локация**: Россия

### Контекст 2024-2026

- Замедление роста IT-рынка
- Кадровый дефицит (500-700 тыс. специалистов)
- AI-трансформация и импортозамещение
- Высокая ставка ЦБ, финансовая нестабильность

### Основные проблемы

1. **Управленческий стресс** — решения, ответственность, неопределённость
2. **Баланс работа-семья** — время на детей, супругу, родителей
3. **Кризис среднего возраста** — смысл, достижения, "что дальше?"
4. **Здоровье** — возрастные изменения, хронический стресс
5. **Синдром самозванца** — "достаточно ли я компетентен?"

---

## Функциональные модули

### Завершённые модули (v3.2)

#### Базовая инфраструктура
- [x] **Базовая структура** — React 18 + Vite + React Router
- [x] **Тёмная/светлая тема** — автопереключение + ручной выбор
- [x] **Chat-based UX** — все пошаговые инструменты в формате чата
- [x] **Тестирование** — Vitest + Testing Library + Playwright
- [x] **PWA** — Service Worker, manifest, оффлайн-режим
- [x] **Apple Liquid Glass** — CSS-based glass effects (iOS 26 style)

#### Экстренная помощь
- [x] **SOS-модуль** — комплексная помощь при панике (бизнес + здоровье контекст)

#### Дыхательные техники
- [x] **Дыхание "Квадрат"** — 4-4-4-4 с анимацией квадрата
- [x] **Дыхание 4-7-8** — с анимированным кругом

#### КПТ-инструменты
- [x] **СТОП-пауза** — chat flow с таймерами
- [x] **Техника 54321** — заземление через органы чувств
- [x] **ABC-дневник** — с чеклистом 10 когнитивных искажений Burns
- [x] **Декатастрофизация** — анализ вероятности + план совладания
- [x] **Двойной стандарт** — "Что бы ты сказал другу?" (Burns, гл. 4)
- [x] **Три колонки** — мысль → искажение → рациональный ответ (Burns, гл. 4)
- [x] **Факты vs Чувства** — отделение интерпретаций от реальности (Burns, гл. 5)
- [x] **Работа с "должен"** — трансформация долженствований (Burns, гл. 5)

#### Стоические практики
- [x] **Дихотомия контроля** — управленческий контекст + шаг действия
- [x] **Утренняя практика** — приоритеты дня, намерение руководителя
- [x] **Вечерняя рефлексия** — обзор решений, благодарность
- [x] **Взгляд сверху** — космическая перспектива
- [x] **Цитаты стоиков** — 40 цитат с категориями (решения, лидерство, команда и др.)

#### Дневник
- [x] **Трекер настроения** — график 7 дней + тренд

---

## Критерии готовности

- [x] Работает на мобильном (iOS Safari, Android Chrome)
- [x] Все формы сохраняют данные в localStorage
- [x] Дыхательная анимация плавная (60fps)
- [x] Тёмная тема не режет глаза
- [x] SOS-кнопка доступна с любого экрана
- [x] Работает офлайн после первой загрузки
- [x] Размер бандла: ~380 KB JS (121 KB gzip)

---

## Референсы

### Методические рекомендации

Полный контент для всех модулей — в файле [health-anxiety-self-help-guide.md](./health-anxiety-self-help-guide.md)

### Когнитивные искажения (Burns)

1. Катастрофизация
2. Предсказание будущего
3. Чёрно-белое мышление
4. Эмоциональное обоснование
5. Сверхобобщение
6. Чтение мыслей
7. Долженствование
8. Персонализация
9. Туннельное зрение
10. Минимизация позитивного

---

## Дорожная карта

### v3.0 (январь 2026) — Chat-based UX ✅
- Все пошаговые инструменты в формате чата
- Apple Liquid Glass дизайн
- 9 chat flows

### v3.1 (январь 2026) — Тестирование ✅
- Unit-тесты хуков (useChatFlow, useTimer, useLocalStorage, useHaptic) — 81 тест
- Компонентные тесты (Button, ThemeContext, Quotes)
- Валидация flow-конфигураций
- E2E тесты (9 сценариев)
- CI/CD с обязательным прохождением тестов

### v3.2 (январь 2026) — КПТ-инструменты Burns ✅
- 4 новых flow из "Терапии настроения" (David Burns)
- Двойной стандарт — самосострадание через перспективу друга
- Три колонки — мысль → искажение → рациональный ответ
- Факты vs Чувства — отделение интерпретаций от реальности
- Работа с "должен" — трансформация долженствований
- Всего 13 chat flows

### v4.0 (январь 2026) — UX-улучшения и экспорт данных ✅
- Экспорт/импорт данных (JSON)
- Статистика использования
- Страница настроек
- Исправлены дыхательные анимации:
  - BoxBreathing: ползунок корректно двигается по всем 4 сторонам квадрата
  - BreathingOverlay: круг увеличивается с первого вдоха, градиентная цветовая индикация
- Исправлено позиционирование кнопки "Назад" на всех экранах (safe-area-top для iOS)
- Документированы UX-паттерны в CLAUDE.md

### v4.1 (планируется) — Расширения
- Синхронизация данных (опционально)
- Напоминания о практиках
- Расширенная аналитика

---

## История изменений

### v4.0 (17 января 2026)
- Экспорт/импорт данных в JSON-формате
- Страница статистики с графиками использования
- Страница настроек (тема, данные)
- Исправлены дыхательные анимации:
  - BoxBreathing: переписана функция getBoxPosition() для корректного движения ползунка
  - BreathingOverlay: добавлен initial scale для анимации первого вдоха, градиентный фон
- Добавлен safe-area-top во все экраны с кнопкой "Назад" (iOS notch support)
- Документированы UX-паттерны в CLAUDE.md (safe-area, дыхательные анимации)

### v3.2 (16 января 2026)
- 4 новых КПТ-инструмента из "Терапии настроения" (David Burns):
  - Двойной стандарт (doubleStandardFlow.js)
  - Три колонки (tripleColumnFlow.js)
  - Факты vs Чувства (factsVsFeelingsFlow.js)
  - Работа с "должен" (shouldStatementsFlow.js)
- Всего 13 chat flows
- Обновлены тесты для валидации новых flows

### v3.1 (15 января 2026)
- Добавлена полная инфраструктура тестирования
- Vitest 0.33.0 + @testing-library/react 14
- Playwright 1.44 для E2E тестов
- 81 unit-тест для хуков
- 9 E2E тест-файлов
- CI/CD: тесты обязательны перед деплоем

### v3.0 (15 января 2026)
- Полный редизайн UX: все пошаговые инструменты переведены на chat-based интерфейс
- Добавлена система flow-конфигураций для декларативного описания диалогов
- Интеграция Framer Motion для анимаций сообщений
- Отказ от `liquid-glass-react` в пользу CSS-based glass effects (fix: blocked clicks)
- Новые компоненты: ChatContainer, ChatMessage, ChatInput, ChatTimer, ChatSlider и др.

### v2.0 (январь 2026)
- Миграция на React + Vite
- Apple Liquid Glass design (iOS 26)
- PWA с оффлайн-режимом

### v1.0 (декабрь 2025)
- Первая версия на чистом HTML/CSS/JS

---

## Связанные документы

- [CLAUDE.md](./CLAUDE.md) — AI-инструкции для Claude Code
- [ARCHITECTURE.md](./ARCHITECTURE.md) — техническая архитектура
- [health-anxiety-self-help-guide.md](./health-anxiety-self-help-guide.md) — контент и методички

---

*Последнее обновление: 17 января 2026*
